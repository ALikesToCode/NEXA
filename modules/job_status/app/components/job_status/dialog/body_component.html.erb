<%= turbo_frame_tag "job_status_modal" do %>
  <% if pending? %>
    <%= component_wrapper do %>
      <div class="op-loading-indicator">
        <div></div>
        <div></div>
      </div>
    <% end %>
  <% else %>
    <%= content_tag :div, "", data: { "job-status-polling-target": "finished" } %>
  <% end %>
  <%= render Primer::Beta::Blankslate.new do |component|
    component.with_visual_icon(icon: icon, size: :medium) unless icon.nil?
    component.with_heading(tag: :h2).with_content(title)
    component.with_description do
      flex_layout do |flex|
        if message.present?
          flex.with_row { render(Primer::Beta::Text.new) { message } }
        end
        if job_errors?
          job_errors.each do |message|
            flex.with_row { render(Primer::Beta::Text.new) { message } }
          end
        end
        if redirect_url.present?
          flex.with_row { render(Primer::Beta::Link.new(
            href: redirect_url,
            target: "_blank",
            data: {
              "job-status-polling-target": job_errors.present? ? nil : "redirect"
            }
          )) { I18n.t('js.job_status.redirect_link') } }
        end
        if download_url.present?
          flex.with_row { render(Primer::Beta::Text.new) { I18n.t('js.job_status.download_starts') } }
          flex.with_row {
            render(Primer::Beta::Link.new(
              href: download_url,
              target: "_blank",
              download: "download",
              data: {
                "job-status-polling-target": "download"
              }
            )) { I18n.t('js.job_status.click_to_download') }
          }
        end
        if job_html.present?
          flex.with_row { job_html.html_safe }
        end
      end
    end
  end %>
<% end %>
